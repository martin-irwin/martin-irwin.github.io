---
layout: pure
title: Search
permalink: /search/
---

<div class="search-container" style="margin-top: 2.8rem;">
  <input type="text" id="search-input" placeholder="type to search..." 
         style="width: 100%; background: transparent; border: none; border-bottom: 1px solid #000; font-family: inherit; font-size: 0.8rem; padding: 5px 0; outline: none; color: #000; border-radius: 0;">
  
  <div id="results-container" style="margin-top: 2.8rem;"></div>
</div>

<script src="https://unpkg.com/lunr/lunr.js"></script>

<script>
  // 1. Fetch the search index generated by Jekyll
  fetch("{{ '/assets/js/lunr/lunr-store.js' | relative_url }}")
    .then(response => response.text())
    .then(text => {
      // The store is usually assigned to a window variable in Minimal Mistakes
      // We evaluate it to get the data
      const strippedText = text.replace('var store = ', '').replace(';', '');
      const store = JSON.parse(strippedText);

      const idx = lunr(function () {
        this.ref('id');
        this.field('title', { boost: 10 });
        this.field('category');
        this.field('content');

        for (var id in store) {
          this.add({
            id: id,
            title: store[id].title,
            category: store[id].category,
            content: store[id].content
          });
        }
      });

      const searchInput = document.getElementById('search-input');
      const resultsContainer = document.getElementById('results-container');

      searchInput.addEventListener('keyup', function () {
        const query = this.value.toLowerCase();
        resultsContainer.innerHTML = '';

        if (query.length < 2) return;

        const results = idx.search(query);

        if (results.length > 0) {
          results.forEach(result => {
            const item = store[result.ref];
            const resultElement = document.createElement('div');
            resultElement.style.marginBottom = '1.4rem';
            resultElement.innerHTML = `
              <div class="entry-item">
                <span style="font-size: 0.7rem; opacity: 0.5; margin-right: 1rem;">result:</span>
                <a href="${item.url}" class="entry-title" style="border-bottom: 1px dotted #000;">${item.title}</a>
              </div>
            `;
            resultsContainer.appendChild(resultElement);
          });
        } else {
          resultsContainer.innerHTML = '<p style="opacity: 0.5;">no results found.</p>';
        }
      });
    });
</script>